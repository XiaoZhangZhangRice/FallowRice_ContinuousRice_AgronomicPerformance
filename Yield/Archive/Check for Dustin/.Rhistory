library(knitr)
library(ggplot2)
theme_set(theme_bw())
library(emmeans)
library(multcomp)
library(PLS205)
library(lme4)
library(lmerTest)
library(multcompView)
library(car)
library(Rmisc)
library(dplyr) #https://r4ds.had.co.nz/ (Chapter 3, Chapter 5, look at filter and select)
# https://bookdown.org/ansellbr/WEHI_tidyR_course_book/
library(stringr)
library(data.table)
library(GGally)
library(formatR)
library(readxl)
library(mgcv)
library(xlsx)
library(knitr)
library(ggplot2)
theme_set(theme_bw())
library(emmeans)
library(multcomp)
library(PLS205)
library(lme4)
library(lmerTest)
library(multcompView)
library(car)
library(Rmisc)
library(dplyr) #https://r4ds.had.co.nz/ (Chapter 3, Chapter 5, look at filter and select)
# https://bookdown.org/ansellbr/WEHI_tidyR_course_book/
library(stringr)
library(data.table)
library(GGally)
library(formatR)
library(readxl)
library(mgcv)
library(xlsx)
master <- read_excel("Grain yield for Dustin.xlsx", sheet = 1)
master <- mutate_if(master, is.character, as.factor)
master$NrateF <- as.factor(master$Nrate)
master$Year <- as.factor(master$Year)
str(master)
yield_2021 <- master %>% filter (Year == "2021")
yield_2022 <- master %>% filter (Year == "2022")
yield_2023 <- master %>% filter (Year == "2023")
#checked datasets, all looks good.
all_factors_model <- lm(Yield_kgha~Year+Blk+NrateF+Field, data = master)
anova(all_factors_model)
all_factors_model <- lm(Yield_kgha~Year**NrateF*Field, data = master)
all_factors_model <- lm(Yield_kgha~Year*NrateF*Field, data = master)
all_factors_model <- lm(Yield_kgha~Year*NrateF*Field, data = master)
anova(all_factors_model)
all_factors_model <- lm(Yield_kgha~Year*NrateF*Field, data = master)
anova(all_factors_model)
yield_2021 <- master %>% filter (Year == "2021")
yield_2022 <- master %>% filter (Year == "2022")
yield_2023 <- master %>% filter (Year == "2023")
#checked datasets, all looks good.
model_2021 <- lmer(Yield_kgha ~ NrateF+Field:NrateF+(1|Field:Blk)+(1|NrateF:Blk), data=yield_2021)
field_means_2021 = emmeans(model_2021,spec = 'Field',by = 'NrateF')
field_effects_2021 = contrast(field_means_2021, method = 'pairwise', adjust = "Tukey")
summary(field_effects_2021)
cld(field_means_2021)
model_2022 <- lmer(Yield_kgha ~ NrateF+Field:NrateF+(1|Field:Blk)+(1|NrateF:Blk), data=yield_2022)
field_means_2022 = emmeans(model_2022,spec = 'Field',by = 'NrateF')
field_effects_2022 = contrast(field_means_2022, method = 'pairwise', adjust = "Tukey")
summary(field_effects_2022)
cld(field_means_2022)
model_2023 <- lmer(Yield_kgha ~ NrateF+Field:NrateF+(1|Field:Blk)+(1|NrateF:Blk), data=yield_2023)
field_means_2023 = emmeans(model_2023,spec = 'Field',by = 'NrateF')
field_effects_2023 = contrast(field_means_2023, method = 'pairwise', adjust = "Tukey")
summary(field_effects_2023)
cld(field_means_2023)
